---
// src/components/CustomHeader.astro
import LanguageSelect from "@astrojs/starlight/components/LanguageSelect.astro";
import Search from "@astrojs/starlight/components/Search.astro";
import SiteTitle from "@astrojs/starlight/components/SiteTitle.astro";
import SocialIcons from "@astrojs/starlight/components/SocialIcons.astro";

const isHomePage =
  Astro.url.pathname === "/" ||
  Astro.url.pathname === "/zh-cn/" ||
  Astro.url.pathname === "/es/" ||
  Astro.url.pathname.endsWith("/index.html");

const isSplash = isHomePage || Astro.props.entry?.data?.template === "splash";
---

<div class="sl-flex px-4 items-center h-full">
  <div class="title-wrapper sl-flex items-center gap-4">
    <SiteTitle {...Astro.props} />
  </div>

  <div class="right-group sl-flex items-center gap-2 sm:gap-4 ml-auto">
    <div class="sl-flex items-center gap-2 relative">
      <Search {...Astro.props} />

      {
        isSplash && (
          <div class="header-lang-picker">
            <LanguageSelect {...Astro.props} />
          </div>
        )
      }
    </div>

    <div
      class="hidden md:flex items-center gap-4 border-l border-white/10 pl-4"
    >
      <SocialIcons {...Astro.props} />
    </div>
  </div>
</div>

<style>
  .header {
    justify-content: space-between;
    height: var(--sl-nav-height);
    background: rgba(var(--sl-color-bg-nav-rgb), 0.8);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--sl-color-hairline);
    overflow: visible !important;
  }

  .right-group {
    overflow: visible !important;
  }

  .header-lang-picker {
    display: flex !important;
    align-items: center;
    position: relative;
  }

  .header-lang-picker :global(select) {
    appearance: none;
    background-color: transparent !important;
    border: 1px solid var(--sl-color-gray-5) !important;
    border-radius: 0.5rem !important;
    padding: 0.25rem 2rem 0.25rem 2.25rem !important; /* 增加左侧间距防止与图标重叠 */
    font-size: 0.75rem !important;
    color: var(--sl-color-white) !important;
    cursor: pointer !important;
    transition: all 0.2s ease;
  }

  .header-lang-picker :global(select:hover) {
    border-color: var(--sl-color-accent-high) !important;
    background-color: rgba(255, 255, 255, 0.05) !important;
  }

  .header-lang-picker :global(svg),
  .header-lang-picker :global(.icon) {
    position: absolute !important;
    left: 0.75rem !important;
    pointer-events: none !important;
    width: 1rem !important;
    height: 1rem !important;
    color: var(--sl-color-gray-3) !important;
    z-index: 10;
  }

  .header-lang-picker :global(svg.caret) {
    left: auto !important;
    right: 0.5rem !important;
  }

  @media (min-width: 50rem) {
    .title-wrapper {
      width: var(--sl-sidebar-width);
    }
    .header-lang-picker {
      display: none !important;
    }
  }
</style>
